<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<fmt:requestEncoding value="utf-8" />
<c:set var="path" value="${pageContext.request.contextPath}" />

<!DOCTYPE html>
<html lang="ko">

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
   content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src = "https://code.jquery.com/jquery-3.7.0.js" type="text/javascript"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<title>ì˜¤í”¼ì…‹</title>

<!-- Custom fonts for this template-->
<link href="${path}/resources/vendor/fontawesome-free/css/all.min.css" rel="stylesheet"
   type="text/css">
<script src="https://kit.fontawesome.com/44ab4b04c0.js"
   crossorigin="anonymous"></script>
<link
   href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
   rel="stylesheet">

<!-- Custom styles for this template-->
<link href="${path}/resources/css/sb-admin-2.min.css" rel="stylesheet">
<script type="text/javascript">
   function edit_check(){
      var n_name = $('#n_name').val()
      var p_number = $('#p_number').val()
      var region = $('#region').val()
      if(n_name ==""){
         alert("ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”.")
         $('#n_name').focus();
      }else if(p_number ==""){
         alert("ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.")  
         $('#p_number').focus();
      }else if(region==""){
         alert("ì§€ì—­ì„ ì…ë ¥í•˜ì„¸ìš”.")
         $('#region').focus();
      }else{
         edit();
      }
   }
   function edit(){
	    var formData = new FormData($('#frm')[0]);
	    
	    $.ajax({
	      type: "POST",
	      url: "${path}/try/profile_edit.do",
	      data: formData,
	      processData: false,
	      contentType: false,
	      success: function (msg) {
	        // ì„œë²„ì—ì„œ ë°˜í™˜í•œ ì‘ë‹µì„ ì²˜ë¦¬
	        if (msg == "Y") {
	          alert("ì‚¬ì›ì •ë³´ ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
	          location.href = "${path}/profile.do";
	        } else {
	          alert("ìˆ˜ì • ì‹¤íŒ¨");
	        }
	      },
	      error: function (err) {
	        console.log(err);
	        alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.");
	      }
	    })
   }
</script>
<script>
$(document).ready( function(){
   $.ajax({
      url:'${path}/checkAtt.do',
      type:'get',
      dataType:'json',
      data:"worker_id="+${worker_id},
      success:function(data){
         //alert('ì„±ê³µ!'+data.check_out+' '+data.check_in)
         if(data.check_in){
            $('#arrvlBtn').attr("disabled",true)
         }
         if(data.check_out){
            $('#leaveBtn').attr("disabled",true)
         }
      }
   })
   
});
</script>
</head>
<body id="page-top">

   <div id="wrapper">
      <%@ include file="sidebar.jsp" %>
      <div id="content-wrapper" class="d-flex flex-column">
         <div id="content">
            <%@include file="topbar.jsp" %>
            <div class="container-fluid">
            
            <h2 class="mr-auto ml-md-3 my-2 my-md-0 mw-100 pb-3">í”„ë¡œí•„ ìˆ˜ì •</h2>
            <div class="container mt-3">
                  <div class="card d-none d-sm-block" style="width:300px">
                  <img class="card-img" src="${path}/up_img/${worker.fname}" alt="Card image" style="width:100%">
                  <div class="card-body d-none d-sm-inline-block">
                     <h4 class="card-title">${worker.name} (${worker.position_name})</h4>
                  </div>
                  </div>
                  <form id="frm" method="post" enctype="multipart/form-data">
                  <input type="file" class="form-control me-2" id="report" placeholder="íŒŒì¼ì„ íƒ" value="${param.report}" name="report" multiple="multiple">
                  <div class="d-none d-sm-block mr-auto ml-md-3 my-2 my-md-0 mw-100" style="width:400px">
                     <div class="card-body">
                        <input type="hidden" id="worker_id" name="worker_id" value="${worker.worker_id}"/>
                        <p class="card-text">ğŸ“›ë‹‰ë„¤ì„ :<input type="text" id="n_name" name="n_name" class="card-text" value="${worker.n_name}"/></p>
                        <p class="card-text">ğŸš©ì†Œì†íŒ€ :<input type="text" id="team_name" class="card-text" value="${worker.team_name}" readonly/></p>
                        <p class="card-text">ğŸ“ì „í™”ë²ˆí˜¸ :<input type="text" name="p_number" id="p_number" class="card-text" value="${worker.p_number}"/></p>
                        <p class="card-text">ğŸ“…ì…ì‚¬ì¼ :<input type="text" id="hire_date" class="card-text" value="${worker.hire_dateS}" readonly/></p>
                        <p class="card-text">ğŸ’²ê¸‰ì—¬ :<input type="text" id="sal" class="card-text" value="${worker.sal}ë§Œì›" readonly/></p>
                        <p class="card-text">ğŸ“ì§€ì—­ : <input type="text" name="region" id="region" class="card-text" value="${worker.region}"/></p>
                        <button type="submit" onclick="edit_check()" href="profile_edit.do" class="btn btn-primary">ìˆ˜ì • ì™„ë£Œ âœ”</button>
                     </div>
                  </div>
                  </form>
            </div>
            <%@include file="footer.jsp" %>
         </div>
      </div>
   </div>
</body>

   <!-- Bootstrap core JavaScript-->
   <script src="${path}/resources/vendor/jquery/jquery.min.js"></script>
   <script src="${path}/resources/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

   <!-- Core plugin JavaScript-->
   <script src="${path}/resources/vendor/jquery-easing/jquery.easing.min.js"></script>

   <!-- Custom scripts for all pages-->
   <script src="${path}/resources/js/sb-admin-2.min.js"></script>



   <!-- Page level custom scripts -->

   <script src="${path}/resources/js/demo/datatables-demo.js"></script>
   
      <script src="${path}/resources/vendor/datatables/jquery.dataTables.min.js"></script>
   <script src="${path}/resources/vendor/datatables/dataTables.bootstrap4.min.js"></script>

   <!-- Page level custom scripts -->
   <script src="${path}/resources/js/demo/datatables-demo.js"></script>


</html>